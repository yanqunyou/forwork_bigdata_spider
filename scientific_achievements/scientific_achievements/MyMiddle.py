# -*- coding: utf-8 -*-#

#-------------------------------------------------------------------------------
# Name:         MyMiddle
# Description:  
# Author:       forwork
# Date:         2018/12/19
#-------------------------------------------------------------------------------
import random
from scrapy.contrib.downloadermiddleware.useragent import UserAgentMiddleware

ips = [
'HTTPS://183.148.153.200:9999',
'HTTPS://115.239.25.250:9999',
'HTTPS://116.209.55.238:9999',
'HTTPS://1.192.242.175:9999',
'HTTPS://121.63.199.122:9999',
'HTTPS://59.62.165.246:808',
'HTTP://110.52.235.203:9999',
'HTTP://125.123.137.255:9999',
'HTTP://112.85.169.16:9999',
'HTTP://116.209.57.100:9999',
'HTTPS://59.62.166.243:9999',
'HTTPS://121.61.3.61:9999',
'HTTPS://116.209.56.133:9999',
'HTTPS://1.192.241.26:9999',
'HTTPS://121.61.1.209:9999',
'HTTP://221.235.236.68:9999',
'HTTP://125.123.140.239:9999',
'HTTP://111.77.197.6:9999',
'HTTP://113.121.144.180:9999',
'HTTPS://125.123.143.35:9000',
'HTTP://115.171.203.201:9000',
'HTTP://219.159.38.201:56210',
'HTTPS://59.62.167.152:53281',
'HTTPS://118.81.45.146:9797',
'HTTPS://1.192.242.217:9999',
'HTTPS://125.123.143.251:9000',
'HTTPS://58.56.108.237:58690',
'HTTP://182.88.247.177:9797',
'HTTP://117.62.61.180:8118',
'HTTPS://1.48.150.26:8118',
'HTTP://112.95.22.127:8888',
'HTTP://14.118.130.214:8081',
'HTTP://180.140.191.233:36820',
'HTTPS://183.172.41.93:8118',
'HTTP://125.123.143.15:9000',
'HTTPS://125.123.142.108:9000',
'HTTP://118.24.127.171:8118',
'HTTPS://58.247.127.145:53281',
'HTTPS://115.239.25.250:9999',
'HTTPS://182.88.148.148:9797',
'HTTPS://116.209.55.238:9999',
'HTTPS://1.192.242.175:9999',
'HTTPS://121.63.199.122:9999',
'HTTPS://59.62.165.246:808',
'HTTPS://59.62.166.243:9999',
'HTTPS://121.61.3.61:9999',
'HTTPS://116.209.56.133:9999',
'HTTPS://1.192.241.26:9999',
'HTTPS://121.61.1.209:9999',
'HTTPS://115.151.3.167:9999',
'HTTPS://115.151.1.172:9999',
'HTTPS://117.91.232.234:9999',
'HTTPS://121.61.1.4:9999',
'HTTPS://116.209.57.26:9999',
'HTTPS://183.148.130.47:9999',
'HTTPS://115.151.7.118:53128',
'HTTPS://110.52.235.149:9999',
'HTTP://110.52.235.203:9999',
'HTTP://125.123.137.255:9999',
'HTTP://112.85.169.16:9999',
'HTTP://116.209.57.100:9999',
'HTTP://221.235.236.68:9999',
'HTTP://125.123.140.239:9999',
'HTTP://111.77.197.6:9999',
'HTTP://113.121.144.180:9999',
'HTTP://221.235.239.111:9999',
'HTTP://59.62.164.17:9999',
'HTTP://110.52.235.138:9999',
'HTTP://125.126.205.168:9999',
'HTTP://121.61.0.95:9999',
'HTTP://125.123.143.207:9999',
'HTTP://121.61.3.192:9999',
'HTTP://111.181.50.0:9999',
'HTTP://125.126.222.165:9999',
'HTTP://125.123.137.91:9999',
'HTTP://125.126.195.243:9999',
'HTTP://112.17.65.133:8060',
'HTTP://183.246.84.229:8060',
'HTTP://222.89.85.158:8060',
'HTTP://218.244.44.194:8060',
'HTTP://221.1.205.74:8060',
'HTTP://120.92.174.37:1080',
'HTTP://152.92.200.74:80',
'HTTPS://202.93.128.98:3128',
'HTTPS://202.162.34.115:53281',
'HTTPS://103.217.156.31:8080',
'HTTPS://212.200.27.134:8080',
'HTTP://39.137.77.68:80',
'HTTP://39.137.77.68:8080',
'HTTP://39.137.77.67:8080',
'HTTP://39.137.77.66:8080',
'HTTP://195.158.2.195:3128',
'HTTP://32.213.126.160:80',
'HTTP://39.137.69.6:8080',
'HTTP://39.137.69.8:8080',
'HTTPS://217.150.77.31:53281',
'HTTP://36.67.7.33:45619',
'HTTPS://62.213.87.174:8080',
'HTTPS://190.60.103.178:8080',
'HTTPS://78.136.243.133:3128',
'HTTPS://88.205.171.222:8080',
'HTTP://213.58.202.70:54214',
'HTTP://80.237.54.158:8080',
'HTTPS://96.80.89.69:8080',
'HTTP://139.162.3.174:8118',
'HTTP://37.187.113.222:80',
'HTTP://202.121.178.244:80',
'HTTP://60.30.19.131:10010',
'HTTP://37.200.224.179:8080',
'HTTP://31.11.177.235:80',
'HTTP://190.81.174.205:3128',
'HTTP://212.83.164.85:80',
'HTTP://103.199.12.12:8080',
'HTTP://196.13.208.23:8080',
'HTTP://120.76.77.152:9999',
'HTTP://47.94.230.42:9999',
'HTTPS://223.99.214.21:53281',
'HTTPS://183.237.206.92:53281',
'HTTPS://60.255.186.169:8888',
'HTTPS://61.135.155.82:443',
'HTTPS://223.223.187.195:80',
'HTTP://153.35.185.71:80',
'HTTP://118.178.227.171:80',
'HTTP://221.10.159.234:1337',
'HTTP://36.110.234.244:80',
'HTTP://39.108.136.37:80',
'HTTP://115.159.31.195:8080',
'HTTPS://223.68.190.130:8181',
'HTTP://39.137.46.72:8080',
'HTTP://39.137.69.10:8080',
'HTTP://39.137.69.9:8080',
'HTTP://112.85.129.165:9999',
'HTTP://124.79.167.34:9797',
'HTTP://183.148.143.175:9999',
'HTTP://110.52.235.55:9999',
'HTTP://182.241.226.25:44969',
'HTTP://111.177.160.100:9999',
'HTTP://163.125.68.226:8888',
'HTTP://218.205.30.61:53281',
'HTTP://118.89.246.49:8118',
'HTTP://218.86.87.171:31661',
'HTTP://219.159.38.208:56210',
'HTTP://121.61.1.164:9999',
'HTTP://118.182.33.8:42801',
'HTTP://116.209.55.115:9999',
'HTTP://121.61.3.158:9999',
'HTTP://110.52.235.173:9999',
'HTTP://117.91.249.249:9999',
'HTTP://121.61.2.146:9999',
'HTTP://114.224.131.142:8118',
'HTTP://117.191.11.72:80',
'HTTP://121.61.3.142:9999',
'HTTP://36.26.228.225:9999',
'HTTP://117.191.11.77:80',
'HTTP://121.61.1.4:9999',
'HTTP://111.177.167.5:9999',
'HTTP://59.62.167.183:9999',
'HTTP://121.61.24.5:9999',
'HTTP://110.52.235.77:9999',
'HTTP://119.145.2.99:44129',
'HTTP://121.61.2.170:9999',
'HTTP://124.94.192.160:9999',
'HTTP://110.52.235.236:9999',
'HTTP://110.52.235.228:9999',
'HTTP://218.91.112.196:9999',
'HTTP://183.63.123.3:56489',
'HTTP://61.189.242.243:55484',
'HTTP://116.209.53.45:9999',
'HTTP://121.61.1.26:9999',
'HTTP://121.61.1.202:9999',
'HTTP://36.228.228.159:8088',
'HTTP://114.55.236.62:3128',
'HTTP://111.177.169.142:9999',
'HTTP://112.85.150.73:9999',
'HTTP://111.177.166.34:9999',
'HTTP://111.177.164.127:9999',
'HTTP://183.148.134.106:9999',
'HTTP://117.131.235.198:8060',
'HTTP://111.177.174.232:9999',
'HTTP://47.110.235.39:3128',
'HTTP://221.235.234.66:9999',
'HTTP://116.209.55.76:9999',
'HTTP://111.177.166.223:9999',
'HTTP://61.135.155.82:443',
'HTTP://121.61.3.62:9999',
'HTTP://115.239.25.58:9999',
'HTTP://111.177.179.0:9999',
'HTTP://110.52.235.178:9999',
'HTTP://221.235.234.77:9999',
'HTTP://111.177.177.215:9999',
'HTTP://119.29.224.144:8118',
'HTTP://222.135.78.190:8060',
'HTTP://110.52.235.98:9999',
'HTTP://221.235.234.19:9999',
'HTTP://111.177.172.185:9999',
'HTTP://180.119.141.182:9999',
'HTTP://125.123.137.185:9999',
'HTTP://118.24.151.76:8118',
'HTTP://58.210.94.242:50514',
'HTTP://116.209.53.84:9999',
'HTTP://110.52.235.183:9999',
'HTTP://111.177.164.246:9999',
'HTTP://221.235.234.128:9999',
'HTTP://112.85.171.125:9999',
'HTTP://27.29.93.65:9999',
'HTTP://110.52.235.71:9999',
'HTTP://123.188.219.149:9999',
'HTTP://183.148.146.207:9999',
'HTTP://121.61.1.220:9999',
'HTTP://125.123.142.212:9999',
'HTTP://111.177.185.151:9999',
'HTTP://110.52.235.232:9999',
'HTTP://116.209.52.229:9999',
'HTTP://115.46.67.117:8123',
'HTTP://125.123.143.255:9999',
'HTTP://111.177.168.46:9999',
'HTTP://39.186.204.89:8118',
'HTTP://116.209.53.126:9999',
'HTTP://121.61.2.102:9999',
'HTTP://110.52.235.27:9999',
'HTTP://163.125.69.27:8888',
'HTTP://59.127.38.117:8080',
'HTTP://115.151.5.103:9999',
'HTTP://121.61.0.36:9999',
'HTTP://110.52.235.250:9999',
'HTTP://111.177.171.136:9999'
]
argents = [
    'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.1 (KHTML, like Gecko) Chrome/14.0.835.163 Safari/535.1',
    'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:6.0) Gecko/20100101 Firefox/6.0',
    'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50',
    'Opera/9.80 (Windows NT 6.1; U; zh-cn) Presto/2.9.168 Version/11.50',
    'Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET CLR 2.0.50727; SLCC2; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; Tablet PC 2.0; .NET4.0E)',
    'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; InfoPath.3)',
    'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; GTB7.0)',
    'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)',
    'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)',
    'Mozilla/5.0 (Windows; U; Windows NT 6.1; ) AppleWebKit/534.12 (KHTML, like Gecko) Maxthon/3.0 Safari/534.12',
    'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; .NET4.0E)',
    'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; .NET4.0E; SE 2.X MetaSr 1.0)',
    'Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US) AppleWebKit/534.3 (KHTML, like Gecko) Chrome/6.0.472.33 Safari/534.3 SE 2.X MetaSr 1.0',
    'Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; .NET4.0E)',
    'Mozilla/5.0 (Windows NT 6.1) AppleWebKit/535.1 (KHTML, like Gecko) Chrome/13.0.782.41 Safari/535.1 QQBrowser/6.9.11079.201',
    'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; .NET4.0E) QQBrowser/6.9.11079.201',
]

# 随机生成UserAgent
class UserAgentMiddlewares(UserAgentMiddleware):

    def process_request(self,request,spider):
        argent = random.choice(argents)
        if argent:
            print(argent)
            request.headers.setdefault('User-Agent', argent)

#随机生成代理（逻辑：从代理池中 随机 获取使用次数较少的代理 返回）
# 目前没有使用，购买代理   使用代理商提供API获取
class ProxyMiddleware(object):

    def process_request(self,request,spider):
        proxy = random.choice(ips)
        if proxy:
            print(proxy)
            request.meta['proxy'] = proxy
